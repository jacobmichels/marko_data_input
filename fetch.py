import requests
import json
import pandas as pd
import time

start = time.time()

people = []

cities = {"Abbotsford": "Abbotsford", "Algonquin Highlands": "Algonquin Highlands", "Alma": "Alma", "Amherst": "Amherst", "Amos": "Amos", "Ancaster": "Ancaster", "Anjou": "Anjou", "Antigonish": "Antigonish", "Atikokan": "Atikokan", "Baie Comeau": "Baie Comeau", "Balmertown": "Balmertown", "Barrie": "Barrie", "Barrington Passage": "Barrington Passage", "Bathurst": "Bathurst", "Beaumont": "Beaumont", "Bedell": "Bedell", "Belleville": "Belleville", "Blainville": "Blainville", "Blaketown": "Blaketown", "Boisbriand": "Boisbriand", "Bonnyville": "Bonnyville", "Boucherville": "Boucherville", "Bowmanville": "Bowmanville", "Bracebridge": "Bracebridge", "Brampton": "Brampton", "Brandon": "Brandon", "Brantford": "Brantford", "Bridgetown": "Bridgetown", "Bridgewater": "Bridgewater", "Brockville": "Brockville", "Brooks": "Brooks", "Brossard": "Brossard", "Burlington": "Burlington", "Burnaby": "Burnaby", "CÃ´te Saint-Luc": "CÃ´te Saint-Luc", "Calgary": "Calgary", "Cambridge": "Cambridge", "Campbell River": "Campbell River", "Canmore": "Canmore", "Cap-aux-Meules": "Cap-aux-Meules", "Caraquet": "Caraquet", "Carleton Place": "Carleton Place", "ChÃ¢teauguay": "ChÃ¢teauguay", "Charlottetown": "Charlottetown", "Chase": "Chase", "Chatham": "Chatham", "Chicoutimi": "Chicoutimi", "Chilliwack": "Chilliwack", "Clarenville": "Clarenville", "Clayton": "Clayton", "Clinton": "Clinton", "Cobourg": "Cobourg", "Collingwood": "Collingwood", "Comox": "Comox", "Concord": "Concord", "Coquitlam": "Coquitlam", "Corner Brook": "Corner Brook", "Cornwall": "Cornwall", "Courtenay": "Courtenay", "Cranbrook": "Cranbrook", "Dartmouth": "Dartmouth", "Dauphin": "Dauphin", "Dawson Creek": "Dawson Creek", "Dayton": "Dayton", "Dolbeau-Mistassini": "Dolbeau-Mistassini", "Dollard-des-Ormeaux": "Dollard-des-Ormeaux", "Dorval": "Dorval", "Drummondville": "Drummondville", "Dryden": "Dryden", "Duncan": "Duncan", "Dundas": "Dundas", "Dutton": "Dutton", "Eastend": "Eastend", "Edmonton": "Edmonton", "Edson": "Edson", "Esterhazy": "Esterhazy", "Estevan": "Estevan", "Etobicoke": "Etobicoke", "Fenwick": "Fenwick", "Flin Flon": "Flin Flon", "Foam Lake": "Foam Lake", "Fort Frances": "Fort Frances", "Fort McMurray": "Fort McMurray", "Fort Nelson": "Fort Nelson", "Fort St. John": "Fort St. John", "Fredericton": "Fredericton", "Gananoque": "Gananoque", "Gander": "Gander", "Garson": "Garson", "GaspÃ©": "GaspÃ©", "Gatineau": "Gatineau", "Gloucester": "Gloucester", "Granby": "Granby", "Grand Falls-Windsor": "Grand Falls-Windsor", "Grande Prairie": "Grande Prairie", "Greely": "Greely", "Grimsby": "Grimsby", "Guelph": "Guelph", "Halifax": "Halifax", "Hamilton": "Hamilton", "Hanover": "Hanover", "Hearst": "Hearst", "Hillcrest Mines": "Hillcrest Mines", "Hinton": "Hinton", "Huntsville": "Huntsville", "Joliette": "Joliette", "JonquiÃ¨re": "JonquiÃ¨re", "Kamloops": "Kamloops", "Kanata": "Kanata", "Kapuskasing": "Kapuskasing", "Kelowna": "Kelowna", "Kenora": "Kenora", "Killarney": "Killarney", "Kindersley": "Kindersley", "Kingston": "Kingston", "Kipling": "Kipling", "Kirkland Lake": "Kirkland Lake", "Kitchener": "Kitchener", "LÃ©vis": "LÃ©vis", "Lachine": "Lachine", "Lambton": "Lambton", "Langley": "Langley", "L'ASSOMPTION": "L'ASSOMPTION", "Laval": "Laval", "Leader": "Leader", "Leduc": "Leduc", "Les Ã‰boulements": "Les Ã‰boulements", "Lethbridge": "Lethbridge", "Lindsay": "Lindsay", "Lloydminister": "Lloydminister", "Lloydminster": "Lloydminster", "London": "London", "Longueuil": "Longueuil", "Lorraine": "Lorraine", "Lucan": "Lucan", "Magog": "Magog", "Manitou": "Manitou", "Marathon": "Marathon", "Markham": "Markham", "Marlbank": "Marlbank", "Marystown": "Marystown", "Meadow Lake": "Meadow Lake", "Medicine Hat": "Medicine Hat", "Melfort": "Melfort", "Melville": "Melville", "Merritt": "Merritt", "Miami": "Miami", "Middleton": "Middleton", "Milton": "Milton", "Miramichi": "Miramichi", "Mississauga": "Mississauga", "Moncton": "Moncton", "Mont-Laurier": "Mont-Laurier", "MontrÃ©al": "MontrÃ©al", "Montreal": "Montreal", "Moose Jaw": "Moose Jaw", "Moosomin": "Moosomin", "Morinville": "Morinville", "Nanaimo": "Nanaimo",
          "Nantes": "Nantes", "Narol": "Narol", "Nelson": "Nelson", "Nepean": "Nepean", "New Glasgow": "New Glasgow", "New Liskeard": "New Liskeard", "New Minas": "New Minas", "New Richmond": "New Richmond", "Newmarket": "Newmarket", "Niagara Falls": "Niagara Falls", "North Battleford": "North Battleford", "North Bay": "North Bay", "North Vancouver": "North Vancouver", "North York": "North York", "Oak Ridges": "Oak Ridges", "Oakville": "Oakville", "Oliver": "Oliver", "Orangeville": "Orangeville", "Orford": "Orford", "Orillia": "Orillia", "Orton": "Orton", "Oshawa": "Oshawa", "Ottawa": "Ottawa", "Outlook": "Outlook", "Owen Sound": "Owen Sound", "Parry Sound": "Parry Sound", "Peace River": "Peace River", "Pembroke": "Pembroke", "Penticton": "Penticton", "Perth": "Perth", "Peterborough": "Peterborough", "Petrolia": "Petrolia", "Pickering": "Pickering", "Pictou": "Pictou", "Pointe-Claire": "Pointe-Claire", "Port Alberni": "Port Alberni", "Port Elgin": "Port Elgin", "Port Hawkesbury": "Port Hawkesbury", "Port Stanley": "Port Stanley", "Portage la Prairie": "Portage la Prairie", "Powell River": "Powell River", "Prince Albert": "Prince Albert", "Prince George": "Prince George", "Provost": "Provost", "QuÃ©bec": "QuÃ©bec", "QUÃ‰BEC": "QUÃ‰BEC", "Quebec": "Quebec", "Quesnel": "Quesnel", "Quispamsis": "Quispamsis", "Red Deer": "Red Deer", "Red Lake": "Red Lake", "Redvers": "Redvers", "Regina": "Regina", "Regina Beach": "Regina Beach", "Repentigny": "Repentigny", "Revelstoke": "Revelstoke", "Rexton": "Rexton", "Richmond": "Richmond", "Richmond Hill": "Richmond Hill", "Ridgetown": "Ridgetown", "Rimouski": "Rimouski", "Roberval": "Roberval", "Rosetown": "Rosetown", "Rothesay": "Rothesay", "Rouyn-Noranda": "Rouyn-Noranda", "Saanichton": "Saanichton", "Saint John": "Saint John", "Saint Raymond": "Saint Raymond", "Saint-Denis-De-Brompton": "Saint-Denis-De-Brompton", "Saint-Georges": "Saint-Georges", "Saint-Sauveur": "Saint-Sauveur", "Salmon Arm": "Salmon Arm", "Salt Spring Island": "Salt Spring Island", "Sarnia": "Sarnia", "Saskatoon": "Saskatoon", "Sault Ste. Marie": "Sault Ste. Marie", "Scarborough": "Scarborough", "Schreiber": "Schreiber", "Seal Cove": "Seal Cove", "Sechelt": "Sechelt", "Selkirk": "Selkirk", "Sept-Iles": "Sept-Iles", "Shannon": "Shannon", "Shawinigan": "Shawinigan", "Shellbrook": "Shellbrook", "Sherbrooke": "Sherbrooke", "Sherwood Park": "Sherwood Park", "Shippagan": "Shippagan", "Sidney": "Sidney", "Simcoe": "Simcoe", "Sioux Lookout": "Sioux Lookout", "Smithers": "Smithers", "Spruce Grove": "Spruce Grove", "St. Albert": "St. Albert", "St. Catharines": "St. Catharines", "St. John's": "St. John's", "St. Marys": "St. Marys", "St.Sauveur": "St.Sauveur", "St-Adelphe": "St-Adelphe", "St-Boniface": "St-Boniface", "ST-DAMIEN-DE-BUCKLAND": "ST-DAMIEN-DE-BUCKLAND", "Ste-Agathe-des-Monts": "Ste-Agathe-des-Monts", "St-FÃ©licien": "St-FÃ©licien", "St-Hyacinthe": "St-Hyacinthe", "St-Laurent": "St-Laurent", "Stratford": "Stratford", "Sudbury": "Sudbury", "Sundridge": "Sundridge", "Surrey": "Surrey", "Sussex": "Sussex", "Swan River": "Swan River", "Swift Current": "Swift Current", "Sydney": "Sydney", "Terrace": "Terrace", "Terrebonne": "Terrebonne", "The Pas": "The Pas", "Thetford Mines": "Thetford Mines", "Thunder Bay": "Thunder Bay", "Tillsonburg": "Tillsonburg", "Timmins": "Timmins", "Toronto": "Toronto", "Trail": "Trail", "Trinity": "Trinity", "Trois-RiviÃ¨res": "Trois-RiviÃ¨res", "Truro": "Truro", "Uxbridge": "Uxbridge", "Val Caron": "Val Caron", "Val d'Or": "Val d'Or", "Vancouver": "Vancouver", "Vermilion": "Vermilion", "Vernon": "Vernon", "Victoria": "Victoria", "Victoriaville": "Victoriaville", "Ville St-Laurent": "Ville St-Laurent", "Wainwright": "Wainwright", "Waterdown": "Waterdown", "Waterloo": "Waterloo", "Watrous": "Watrous", "Watson": "Watson", "Westbank": "Westbank", "Westlock": "Westlock", "Westmount": "Westmount", "Weyburn": "Weyburn", "Whitby": "Whitby", "Whitehorse": "Whitehorse", "Williams Lake": "Williams Lake", "Windsor": "Windsor", "Winnipeg": "Winnipeg", "Woodstock": "Woodstock", "Yellowknife": "Yellowknife", "Yorkton": "Yorkton"}
for city in cities:
    print(f"Getting people for {city}...")
    headers = {"Accept": "*/*", "Accept-Encoding": "gzip, deflate, br"}
    res = requests.get(
        f"https://search.investorsgroup.com/api/cwpsearch?&city={city}&name=&Pcode=&geo=&lang=en&searchtype=con", headers=headers)
    results = json.loads(res.json())
    for result in results:
        person = {"Province": result["myInfo"]["State"], "City": city, "Branch": city,
                  "First Name": result["myInfo"]["FName"].title(), "Last Name": result["myInfo"]["LName"].title(),
                  "e-mail": result["myInfo"]["Email"], "Phone Number": result["myInfo"]["Phone"],
                  "Website": "https://www.ig.ca/en/find-an-advisor", "Direct Link": result["myInfo"]["ConsultantUrl"]}
        people.append(person)
print("Done. People list length: ", len(people))

df = pd.DataFrame(data=people)
output_file = "output.xlsx"
df.to_excel(output_file)
end = time.time()
print(f"{output_file} created. \n Done in {end-start} seconds.")
